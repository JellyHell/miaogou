<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.miaogou.dao.ISystemBackDao">

	<select id="getGoodsList" resultType="Map">
			SELECT
			a.goods_code,
			a.goods_name,
			case a.goods_class
			     when 'bj' then '保健'
			     when 'xs' then '香水'
			     else '未知分类'
			     end goods_class,
			a.price,
			a.iconImg,
			b.brand,
			b.firstBrand,
			b.secondBrand,
			b.introduce,
			b.introducePrice,
			b.introduceUrl,
			GROUP_CONCAT(
				c.`code`,
				'#',
				c.url,
				'#',
				IFNULL(c.isBigImg, '0')
			) imglist
		FROM
			mg_goods a
		LEFT JOIN mg_goodsdetails b ON a.goods_code = b.goods_code
		LEFT JOIN mg_attachment c ON a.goods_code = c.tabCode
		GROUP BY
			a.goods_code,
			a.goods_name,
			a.goods_class,
			a.price,
			a.iconImg,
			b.brand,
			b.firstBrand,
			b.secondBrand,
			b.introduce,
			b.introducePrice,
			b.introduceUrl
	</select>
</mapper>